<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta content="telephone=no" name="format-detection">
    <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <title>商品详情</title>
    <link rel="stylesheet" href="../../css/zui.css">
    <link rel="stylesheet" href="../../css/style.css">

    <style> 
        .paimai_box2 .title {
            width: 6em;
        }

        img {
            max-width: 100% !important;
            height: auto
        }
    </style>
</head>

<body>
<div class="zui-app paimai_list_main">
    <div class="zui-header zui-header-dark zui-row-center">
        <div class="iconfont icon-back zui-header-icon zui-header-left" onclick="jw.back()"></div>
        <div class="zui-header-title" onclick="api.closeToWin({'name':'root'})">竞价详情</div>
        <div class="iconfont zui-header-icon icon-fenxiang1 zui-header-right" @click="share()"></div>
        <div class="iconfont icon-fangzi zui-header-icon zui-header-right"  style="right: 45px;font-size:30px"
            onclick="jw.openWin({'name':'index','url':'../../index3.html'})"></div>
    </div>
    <div class="zui-content maxin_box">

        <div class="paimai_details_header">
            <div class="">
                <!-- <div >{{order.FImg}}</div> -->
                <!-- <img src="../../image/paimai_img.png" alt=""> -->
                <img style="width: 100%; height: 100%;" :src="order.FImg | url" alt=""/>
                <!--<div class="fenxiang" @click="share()"><i class="iconfont icon-share-fill"></i>分享</div>-->
            </div>
            <div class="zui-row zui-row-center fz14" style="margin-top:-10px"  v-show="order.subTitle2secondsum > 0">
                <div class="timebox z-btn-red"  style="margin-left: 0;font-size: 18px;width: 100%;">{{order.subTitle2}}
                    <span id="timeobj" style="font-size: 18px" :data-time="order.subTitle2secondsum"></span>
                </div>
            </div>
            <div class="title zui-row zui-row-center">
                <div class="zui-col">{{order.FTitle}}</div>
                <!-- <div class="fenxiang" @click= "share()" style="z-index: 99;"><i
                        class="iconfont icon-share-fill"></i>分享
                </div> -->
            </div>
            <div class="title" v-cloak v-if="order.FStatus == 0" style="padding: 0 17px;">
                <span style="display: block;color: #aaa;" v-if="order.FType!=1">RMB</span>
                <span class="fz12">起拍价</span>
                <b class="color-red" style="font-size:20px;">{{order.FCost}}</b>
                <span class="rtet">{{order.FType==1?"积分":"元"}}</span>
            </div>
            <div class="title"  v-cloak v-if="order.FStatus !== 0" style=" padding: 0 17px;">

                <span class="fz12 color-red" >
                    <span style="display: block;color: #aaa;margin-bottom:-15px;" v-if="order.FType!=1" >RMB</span>当前价</span>
                <b class="color-red" style="font-size: 28px;"  v-if="order.FCostTxt=='' || order.FCostTxt ==undefined || order.FCostTxt==null">{{order.FCost}}</b>
                <b class="color-red" style="font-size: 28px;"  v-else>{{order.FCostTxt}}</b>
                <span>{{order.FType==1?"积分":"元"}}</span>
            </div>
            <div class="llbox zui-row zui-row-center" v-cloak>
                <div class="zui-col">浏览 {{order.FRead}} 次</div>
                <div class="zui-col">报名 {{order.AuctionMember}} 人</div>
                <div class="zui-col">竞价 {{order.AuctionCount}} 次</div>
            </div>
        </div>

        <div class="paimai_box2">
            <div class="zui-row zui-row-center">
                <div class="zui-col">
                    <span class="title">竞价类型</span>
                    <span>{{order.FType==1?"积分":"现金"}}</span>
                </div>
                <div class="zui-col">
                    <span class="title">起拍</span>
                    <span>{{order.FCost}}{{order.FType==1?"积分":"元"}}</span>
                </div>
            </div>
            <div class="zui-row zui-row-center">
                <div class="zui-col">
                    <span class="title">保证金</span>
                    <span>{{order.FDeposit}}{{order.FType==1?"积分":"元"}}</span>
                </div>
                <div class="zui-col">
                    <span class="title">加价幅度</span>
                    <span>{{order.FNum}}{{order.FType==1?"积分":"元"}}</span>
                </div>
            </div>
            <div class="zui-row zui-row-center">
                <div class="zui-col">
                    <span class="title">开拍时间</span>
                    <span>{{order.FOpenTime}}</span>
                </div>

            </div>
            <div class="zui-row zui-row-center">
                <div class="zui-col">
                    <span class="title">结束时间</span>
                    <span>{{order.FEndTime}}</span>
                </div>

            </div>



            <!--<div class="zui-row zui-row-center">-->
            <!--<div class="zui-col">-->
            <!--<span class="title">保留价</span>-->
            <!--<span>{{order.FBLCost}}</span>-->
            <!--</div>-->
            <!--<div class="zui-col">-->
            <!--<span class="title">延迟筑起</span>-->
            <!--<span>{{order.FYSCost}}</span>-->
            <!--</div>-->
            <!--</div>-->
        </div>
        <!-- 竞价说明 -->
        <div>
            <div class="paimai_title">竞价说明</div>

            <div class="paimaishuoming1">
                <img class="img" src="../../image/paimaishuoming.png" alt="">
            </div>
            <div class="paimaishuoming2 fz14">
                <div class="zui-row zui-row-center">
                    <span class="text">当前出价人数：{{jpname.FMember}}人</span>
                    <span class="time zui-col text-center">{{jpname.timenow}}</span>
                    <a href="javascript:;" class="update" @click="gxcj()">更新出价</a>
                </div>
                <div class="zui-row zui-row-center fz14" >
                    <input hidden id = "order_subTitle1" v-model="order.subTitle1"/>
                    <span class="text color-red" >{{order.subTitle1}}</span>
                    <!-- <span class="zui-col text-right"
                          style="font-size: 10px;">（起{{order.FCost}}/加{{order.FNum}}{{order.FType==1?"积分":"元"}}）</span> -->
                </div>
                <div style="text-align: right" class="update" @click="paimairen()">出价记录</div>

            </div>
            <div class="paimaichujia_list" style="border-bottom: 1px solid #ccc;margin: 3px;"
                 v-for="(item,index) in memberlist">
                <div class="item zui-row zui-row-center">
                    <div class="txbox"><img width="40" :src="item.FHanderImg | url" alt=""></div>
                    <div class="zui-col">
                        <p class="fz14">{{item.FName | filtName}}</p>
                        <b class="fz16 color-orange">{{item.FNum}}</b>
                    </div>
                    <div class="rbox">
                        <img width="45" :src="item.isFirstUrl | url" alt=""/>
                        <p class="fz14">{{item.FCreateTime}}</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="zui-row paimai_nav">
            <div class="zui-col nav" :class="{'selected':navindex==1}" @click="navclick1(1)">商品</div>
            <div class="zui-col nav" :class="{'selected':navindex==2}" @click="navclick1(2)">参数</div>
            <div class="zui-col nav" :class="{'selected':navindex==3}" @click="navclick1(3)">说明</div>
        </div>

        <div v-show="navindex == 1">
            <div v-html="htmlsrc(order.FContent)"></div>
        </div>
        <div v-show="navindex == 2">

            <img id="parameters" style="width: 100%;" @click="canshuimg(imgsrcfilter(order.parameters))"
                 v-show="order.parameters!=null&&order.parameters!=undefined"
                 :src="imgsrcfilter(order.parameters)" alt="">
        </div>
        <div v-show="navindex == 3">
            <img id="parameters2" style="  width:100%;object-fit:cover;" @click="canshuimg(imgsrcfilter(order.shuoming))"
                 v-show="order.shuoming!=null&&order.shuoming!=undefined"
                 :src="imgsrcfilter(order.shuoming)" alt="">
        </div>
    </div>

    <!-- 商品详情 底部 -->
    <div style="background-color: #fff;" class="zui-footer zui-row zui-row-center">
        <!-- <div class="paimai_btn">
            <i class="iconfont icon-kefu"></i>
            <span class="fz16 color-blue" @click="lxkf()">联系客服>></span>
        </div> -->
        <div class="zui- " style="width:20%; font-size:14px;text-align:center;line-height:20px;"   @click="kefushow = true"><i class="iconfont icon-kefu color-red" style="display: block;text-align:center;margin-top:5px;"></i>咨询</div>
        <!-- {{order.btnStatu}} -->
        <div style="border-radius: 30px 0 0 30px; font-size: 12px; text-align: center; padding: 8px 0;"
             class="zui-col bg-red color-white" v-if="order.btnStatu && order.FStatus==1" @click="justbuy()">
            <div>{{order.btnTitle}}</div>
            <div>(保证金){{order.FDeposit}}{{order.FType==1?"积分":"元"}}</div>
        </div>
        <div style="border-radius: 30px 0 0 30px; font-size: 15px; text-align: center; padding: 8px 0;"
             class="footer_btn zui-col bg-cancel color-white" v-if="order.btnStatu && order.btnTitle=='跳转到订单'" @click="jump()">
            <div>{{order.btnTitle}}</div>
        </div>
        <div style="border-radius: 30px 0 0 30px; font-size: 15px; text-align: center; padding: 3px 0;"
             class="footer_btn zui-col bg-cancel color-white" v-if="order.btnStatu && order.FStatus!==1 && order.btnTitle!='跳转到订单'" v-show="openbtn=true">
            {{order.btnTitle}}
        </div>
    </div>
    <!-- 商品详情 底部 end -->

    <!-- 客服弹出框 -->
    <!-- <div class="zui-alert shop_alert" v-cloak v-if="kefushow">
        <div class="zui-alert_box">
            <div class="shop_close iconfont icon-del color-red" @click="kefushow = false"></div>
            <div class="tip">
                <div class="iconfont icon-kefu"></div>
            </div>
            <div class="title">咨询电话</div>
            <div class="cont">联系方式：<a href="Tel:15867203999">15867203999</a></div>
        </div>
        <div class="zui-alert_bg"></div>
    </div> -->
    <div class="zui-alert shop_alert" v-cloak v-if="kefushow">
        <div class="zui-alert_box">
            <div class="shop_close iconfont icon-del color-red" @click="kefushow = false"></div>
            <div class="tip">
                <div class="iconfont icon-kefu"></div>
            </div>
            <div class="title">咨询电话 | 微信客服</div>
            <div class="cont">
            <input id="foo1"  value="15867203999" readonly="readonly" style="width:35%; font-size:18px;">
            <button class="btn"  data-clipboard-target="#foo1" style="color:#fff;background-color:#676767;">复制</button>


            <a href="Tel:15867203999" style="display:link-block; padding:1.5px 5px 3px; font-size:14.5px;color:#fff;background-color:#c23a4d;">呼叫</a></div>
        </div>
        <div class="zui-alert_bg"></div>
    </div>
    <!-- 客服弹出框 end -->

    <div class="z-popup paimai_chujia_modal" v-if="addoneshow">
        <div class="z-popup_modal popup-bottom zui-row zui-row-column">
            <div class="zui-col chujia_content">
                <div class="zui-list2 paimai_list">

                    <div class="item">
                        <div class="img">
                            <img alt="">
                        </div>
                        <!--<div class="touxiang img" :style="getbgimg(order.FImageUrl)"></div>-->
                        <div class="">
                            <!--                                 <p class="title"></p>-->
                            <!--                                 <p>领先价：100积分</p>-->



                            <!-- <p style=" display: inline; width:100%;text-align: left; vertical-align: middle; line-height: 2.8rem;"> -->

                            <p style="margin-left: -20.5%">


                                        <!-- <span class="" style="font-size: 20px;width: 20%;" @click="JiaJIa()">&nbsp;—</span> -->

                                        <!--                                    <span style="width: 100px; line-height: 2.5rem; display: inline-block;">自定义金额</span>-->
                                        <!-- <input id="number" v-model="FNum" type="number" class="zui-header-seach" -->


                                        <!-- <input v-else id="number"  type="number" class="zui-header-seach"
                                               placeholder="请输入自定义金额" style="text-align: center;  line-height: 2rem;
                                                    border-radius: 0px; width: 60%; line-height: 2.8rem; display: inline-block;
                                                    border: #cccccc 0.2px solid"
                                               pattern="[0-9]*"
                                               onkeyup="if(this.value.length==1){this.value=this.value.replace(/[^1-9]/g,'')}else{this.value=this.value.replace(/\D/g,'')}"
                                               onafterpaste="if(this.value.length==1){this.value=this.value.replace(/[^1-9]/g,'0')}else{this.value=this.value.replace(/\D/g,'')}"
                                               > -->

                                        <input  id="number"  type="number"
                                               placeholder="请输入自定义金额" style="text-align: center;  line-height: 2rem;
                                                    border-radius: 0px; width: 60%; margin-left:30px; margin-top:10px;line-height: 2.8rem; display: inline-block;
                                                    border: #cccccc 0.2px solid;position: relative;"
                                               pattern="[0-9]*"
                                               onkeyup="if(this.value.length==1){this.value=this.value.replace(/[^1-9]/g,'')}else{this.value=this.value.replace(/\D/g,'')}"
                                               onafterpaste="if(this.value.length==1){this.value=this.value.replace(/[^1-9]/g,'0')}else{this.value=this.value.replace(/\D/g,'')}"
                                               @input="changeInput()"
                                               >
                                               <button style="font-size: 25px;width: 10%;position: absolute;top:50%;left:11.5%;transform: translateY(-50%);"@click="JianJia()" > —</button>
                                        <button  style="width: 10%;font-size: 25px;position: absolute;top:50%; right:10%;   transform: translateY(-50%);" @click="JiaJIa()">+</button>
                            </p>


                            <!-- <input hidden id="order_FNum" v-model="order.FNum+order.FCostTxt"> -->
                            <div style="vertical-align: middle; margin-top: 10px;text-align: center;margin-left: -25%">
                                <!-- <span class="tag1">{{order.FNum}}{{order.FType==1?"积分":"元"}}加一手</span> -->
                            </div>
                        </div>
                    </div>

                </div>
            </div>
            <div class="chujia_modal_footer" @click="chujiabtn(0)">
                出个价
            </div>
        </div>
        <div class="z-popup_bg" @click="chgj()"></div>
    </div>

    <!-- 立即兑换弹出框 -->
    <!--<div class="zui-alert duihan">-->
    <div class="zui-alert duihan" v-cloak v-if="duihuanshow">
        <!--<div class="zui-alert_box jfdh_box">-->
        <div class="zui-alert_box jfdh_box" v-cloak v-if="set">
            <div class="jf_duihuan">
                <div class="jf_btn">
                    <div class="shop_close jfonbtn iconfont icon-del color-white" @click="duihuanshow = false">
                    </div>
                </div>
                <div class="wrat_main">
                    商品地址
                </div>
                <div class="jf_img">
                </div>
                <div class="nav_text">
                    <p>您还未填写收货地址!</p>
                    <p>是否前往填写</p>
                </div>
                <div class="max_bottom">
                    <div class="zui-alert_main duihan_alert_main" @click="dhcg">
                        是
                    </div>
                    <div class="zui-alert_footer duihan_alert_footer" @click="duihuanshow = false">
                        否
                    </div>
                </div>
            </div>
        </div>
        <div class="zui-alert_bg"></div>
    </div>

    <!-- 交保证金 -->
    <div class="zui-alert baozhengjinalert" v-show="bzjshow" v-cloak>
        <div class="zui-alert_box">
            <div class="box">
                <div class="close" @click="bzjshow=false"><img src="../../image/close.png" alt=""></div>
                <div class="z-btn z-btn-bolck z-btn-noradius z-btn-s z-btn-red">{{bzjtext}}</div>
                <div class="text1">若竞价未成功，保证金将在竞价结束 后1-15个工作日解冻至电子钱包！</div>

                <div class="btnlist zui-row text-center">
                    <div class="zui-col z-btn z-btn-red z-btn-s z-btn-radius50" @click="chujiabtn(1)">确认</div>
                    <div class="zui-col z-btn z-btn-cancel z-btn-s z-btn-radius50" @click="bzjshow=false">取消</div>
                </div>
            </div>
        </div>
        <div class="zui-alert_bg"></div>
    </div>

    <!-- 充值保证金 -->
    <!--<div class="zui-alert baozhengjinalert">-->
    <div class="zui-alert baozhengjinalert" v-show="bzjczshow" v-cloak>
        <div class="zui-alert_box">
            <div class="box">
                <div class="close" @click="bzjczshow=false"><img src="../../image/close.png" alt=""></div>
                <div class="img text-center"><img width="80" src="../../image/bzj2.png" alt=""></div>
                <div class="fz14">您的保证金不足，请立即充值！</div>
                <div class="btnlist zui-row text-center">
                    <div class="zui-col z-btn z-btn-red z-btn-s z-btn-radius50" @click="gochongzhi()">去充值</div>
                    <div class="zui-col z-btn z-btn-cancel z-btn-s z-btn-radius50" @click="bzjczshow=false">取消</div>
                </div>
            </div>
        </div>
        <div class="zui-alert_bg"></div>
    </div>

    <div class="z-popup paimai_bzj" v-show="baozhengjin">
        <div class="z-popup_modal popup-bottom zui-row zui-row-column zui-row-stretch zui-row-center">
            <div class="zui-col">
                <div class="paimai_bzj_title"><i class="iconfont icon-jinggao"></i> &nbsp;本次操作将冻结相应保证金，没有拍到，保证金将原路退回
                </div>
                <div class="zui-item zui-row zui-row-center">
                    <div class="zui-col">保证金</div>
                    <div class="fz16 color-gray6">10积分</div>
                </div>
                <div class="paimai_placeitem" @click="choseplace()">
                    <p class="tip">请选择收货地址</p>
                    <div class="item zui-row zui-row-center">
                        <div class="zui-col">
                            <div class="zui-row zui-row-center">
                                <div class="title">收货人</div>
                                <div class="text zui-col">
                                    {{FUserName}}
                                    &nbsp;&nbsp;&nbsp;&nbsp;
                                    <span>{{FMobile}}</span>
                                </div>
                            </div>
                            <div class="zui-row">
                                <div class="title">收货地址</div>
                                <div class="text zui-col">{{FShippingAddress}}</div>
                            </div>
                        </div>
                        <div class="iconfont icon-right"></div>
                    </div>
                </div>
            </div>
            <div class="zui-radiolist" style="padding: 5px 15px;">
                <label class="zui-radiobox">
                    <input type="radio">
                    <i class="zui-checked"></i>
                    <input type="checkbox" class="zui-radiotxt">我已查看竞价协议</input> &nbsp;&nbsp;&nbsp; <span
                        class="color-blue">查看协议</span>
                </label>
            </div>
            <div class="zui-footer bg-red color-white text-center fz18" style="line-height: 44px;" @click="">确认
            </div>
        </div>
        <div class="z-popup_bg"></div>
    </div>

</div>

<script src="../../js/jquery-2.1.1.min.js"></script>
<script src="../../js/vue.js"></script>
<script src="../../js/vuefilter.js"></script>
<script src="../../js/jw.js"></script>
<script src="../../js/zui.js"></script>
<script src="../../js/clipboard.min.js"></script>
</body>
<script>
    apiready = function () {
        jw.sb.fixStatusBar(".zui-header");

        // jw.ts.jiazaiShow({
        //     modal : false
        // });
        //
        //商品倒计时
        var timeobj = setInterval(function () {
            var starttime = $("#timeobj");
            var t1 = starttime.data("time");
            //alert(1)
            if (t1 > 0) {
                starttime.data("time", parseInt(t1 - 1))
                var t1_s = zDate.expireTime(t1);
                $("#timeobj").text(t1_s);
            } else {
                clearInterval(timeobj);
                //jw.ts.toast("竞价已结束！")
                myapp.paimeilist();
            }
        }, 1000);

        // 显示抢购 剩余时间
        setInterval(function () {
            var FEndTime = myapp.order.FEndTime;
            if (FEndTime == undefined || FEndTime == null || FEndTime == '') {
                return;
            }
            FEndTime = FEndTime.replace("T", " ");

            var t1_s = zDate.getendtimehoures(FEndTime);
            $(".starttime").text(t1_s);
        }, 1000);

        // 获取选择地址
        jw.data.jtget("chose_address", function (ret) {
            if (typeof (ret) == "string") {
                ret = JSON.parse(ret);
            }
            myapp.FShippingAddressId = ret.FShippingAddressId;
            myapp.FUserName = ret.FUserName;
            myapp.FMobile = ret.FMobile;
            myapp.FShippingAddress = ret.FShippingAddress;
        });

        var m = 3000;
        var ms = [3000, 4000, 5000];
        var count = 0;
        m = ms[Math.floor(Math.random() * ms.length)];

        var inval = setInterval(function () {
            jw.ts.jiazaiHide();
            jw.submit("api42275", { // 移动端sql > 二期 > 竞价 > 竞价详情api42151
                    FId: api.pageParam.FId, //活动id
                    FUserId: jw.data.get("userid") //登录id
                },
                function (data) {
                    try {
                        if($('#order_subTitle1').val() == '竞价已结束'){
                            clearInterval(inval);
                        }
                        //jw.ts.jiazaiHide();
                        myapp.paimeilist();
                        myapp.gxcj();
                        //myapp.dzqw();
                        
                        if (data != null && data.ds3 != undefined && data.ds3 != null && data.ds3[0].IsChaoYue > 0) {
                            if(null == localStorage.getItem(api.pageParam.FId+"_tempIsChaoYue") || localStorage.getItem(api.pageParam.FId+"_tempIsChaoYue") == 0){
                                showMsg();
                                setTemp(data.ds3[0].IsChaoYue,data.ds3[0].FNum);
                            }
                            //alert(123)
                            jw.ts.jiazaiHide();
                            myapp.paimeilist();
                            myapp.gxcj();
                            myapp.dzqw();
                            //clearInterval(inval);
                            return;
                        }
                        setTemp(data.ds3[0].IsChaoYue,data.ds3[0].FNum);
                    } catch (e) {
                        console.error(e);
                    }
                }, {jz: false});
        }, m);

        function setTemp(isChaoYue,fNum) {
            localStorage.setItem(api.pageParam.FId+"_tempIsChaoYue",isChaoYue);
            //console.error("_tempIsChaoYue----->"+localStorage.getItem(api.pageParam.FId+"_tempIsChaoYue"));
        }

        function showMsg() {
            api.toast({
                msg: '你已被超越',
                duration: 2000,
                location: 'top'
            });

            //弹出状态栏通知
            api.notification({
                vibrate: [100, 500, 200, 500, 300, 500, 400, 500],
                notify: {
                    title: '观今茶仓',
                    content: '你的竞价出价已被超越'
                },
                sound: 'default'
            });
        }

        var myapp = new Vue({
            "el": ".zui-app",
            data: {
                navindex: 1, // 选项卡
                // Ftype: api.pageParam.Ftype, // 0： 茶商城 1：茶市
                // FBusinessId: api.pageParam.FBusinessId, // 商品ID
                // FPageType: api.pageParam.FPageType, // 页面来源 1，限时抢购 2、普通
                // FBusinessId: api.pageParam.FBusinessId, // 商品ID
                // FlashSaleId: api.pageParam.FlashSaleId, // 限时抢购ID
                kefushow: false,
                order: {},
                addoneshow: false, //关闭弹窗
                mocktime: false, //竞价时间
                memberlist: [], //竞价人员
                jpname: "", //当前时间
                newbtn: false, //按钮状态
                openbtn: false, //按钮隐藏
                duihuanshow: false, //立即兑换
                dhshow: false, //兑换成功
                set: true, //兑换完成
                bzjtext: "",
                bzjshow: false, // 交保证金 弹出框显示隐藏
                bzjczshow: false, // 保证金充值 弹出框显示隐藏
                baozhengjin: false,
                FShippingAddressId: "", // 收获地址ID
                FUserName: "", //收货人姓名
                FMobile: "", //收货人电话
                FShippingAddress: "", //收货地址
                FNum: null, //出价
                PDinput:0,
                inputsave:0,
                timeout: null,
                zhuangtai:0//判断是不是第一次进入
            },
            created: function () {
                this.paimeilist();
                this.zhuangtai = 1
                // if (this.ticker) { //这一段是防止进入页面出去后再进来计时器重复启动
                //     clearInterval(this.ticker);
                // }
                this.gxcj();
                this.dzqw();
                //$("#number").val(_this.order.FNum)
                // setTimeout(function(){
                //     if(this.jpname.FMember>=1){
                //         $("#number").val(_this.order.FNum)
                //     }else{
                //         $("#number").val(this.order.FNum+this.order.FCost)
                //     }
                // },1000)

            },
            methods: {
                // 选择地址
                choseplace: function () {
                    jw.openWin({
                        name: "chose_address",
                        url: "../shangcheng/chose_address.html"
                    });
                },
                // time: function (time, flag) { //这个函数是每秒把时间重新计算下
                //     if (time >= 0) {
                //         return zDate.expireTime(time);
                //     }
                // },
                canshuimg: function (imgsrc) {

                    photoBrowser.open({
                        images: [imgsrc],
                        placeholderImg: 'widget://res/loading.gif',
                        bgColor: '#000'
                    }, function (ret, err) {
                        if (ret.eventType == "click") {
                            photoBrowser.close();
                        }
                    });

                },
                paimairen:function(){
                    var _this = this
                    var y = $(".zui-content").offset().top;
                    var x = $(".zui-content").offset().left;
                    jw.openFrame({
                        'name': 'paimairenxq',
                        'url': 'paimairenxq.html',
                        pageParam: {
                            FId: api.pageParam.FId
                        },
                    })
                },
                paimeilist: function () {
                    var _this = this;
                    //api42151 竞价详情
                    jw.submit("api42151", { // 移动端sql > 二期 > 竞价 > 竞价详情api42151
                            FId: api.pageParam.FId, //活动id
                            FUserId: jw.data.get("userid"), //登录id
                            zhuangtai:_this.zhuangtai
                        },
                        function (data) {
                            if (data.ds != undefined && data.ds != "" && data.ds[0].status ==
                                "000000") {
                                _this.zhuangtai = 1;
                                _this.order = data.ds1[0];
                            } else {
                                jw.ts.toast(data.ds[0].msg);
                            }
                        });
                    // jw.submit("app_商品详情new", {
                    //     FId: api.pageParam.FId, //商品id
                    //     FUserId: jw.data.get("userid"), //   用户id
                    //     FType: _this.FPageType,
                    // }, function (ret) {
                    //     _this.initshow = true;
                    //     if (ret.ds != undefined && ret.ds != "" && ret.ds[0].status == "000000") {
                    //         _this.shopdetails = ret.ds1[0];
                    //         if (_this.FPageType == 2) {
                    //             // 是否已点赞
                    //             _this.zan = ret.ds2[0].ifPraise;
                    //         }

                    //         _this.$nextTick(function () {
                    //             imgclick();
                    //         });

                    //     } else {
                    //         jw.ts.toast(ret.ds[0].msg);
                    //     }
                    // });
                },
                dzqw: function () {
                    var _this = this;
                    setTimeout(function () {
                        // alert(_this.order.ifAddAddress);
                        if (_this.order.ifAddAddress == 1) {
                            this.duihuanshow = true //显示隐藏的兑换页面
                        }
                    }, 400);
                },
                //改变的时候
                changeInput:function(){
                    var _this = this;
                    var _inputsave = 0;
                    var allmoney = parseInt(_this.order.FNum)+parseInt(_this.order.FCostTxt)//所有的钱
                    var DFmoney = parseInt(_this.order.FNum) //加价幅度
                    var DQmoney = parseInt(_this.order.FCostTxt)//当前最高价
                    var QPmoney = parseInt(_this.order.FCost)//起拍价
                    //alert(_this.order.ifAddAddress);
                    clearTimeout(_this.timeout);
                        _this.timeout = setTimeout(() => {
                            var inputmoney = parseInt($('#number').val())//input金额
                            if(inputmoney<allmoney){
                                //$('#number').val(allmoney)
                                //alert(123)
                            }
                            else if ((inputmoney-QPmoney)%DFmoney !=0) {
                                $('#number').val(allmoney)
                                //var yushu = DFmoney-(inputmoney-QPmoney)%DFmoney//算出余额 还差多少
                                 var yushu = (inputmoney-QPmoney)%DFmoney//算出余额 还差多少
                                $('#number').val(inputmoney-yushu)//往上加
                                _inputsave =  $("#number").val()
                                if(_inputsave!=undefined && _inputsave !=null && _inputsave !=''){
                                    _this.inputsave = _inputsave
                                }
                            }
                    }, 700);
                    if(_inputsave!=undefined && _inputsave !=null && _inputsave !=''){
                        $("#number").val(_inputsave)
                        _this.inputsave = _inputsave
                        }else{
                            _this.inputsave =  $("#number").val()
                        }
                },
                //兑换详情页
                dhcg: function () {
                    this.set = false;

                    var FShoppingCarIds = [];
                    jw.openWin({
                        name: "shoppingCar_pickGoods",
                        url: "../shangcheng/shoppingCar_pickGoods.html",
                        // pageParam: {
                        //         FShoppingCarIds: FShoppingCarIds.join(),
                        //         ly: "my_Shopping_Cart",
                        //     }
                    })
                    // if(this.dhshow=true){
                    //     jw.submit("api41880",{
                    //         FId:this.duihuanbtn,//商品id
                    //         FUserId:jw.data.get("userid")//登陆人id
                    //     },function(datanum){
                    //         if(datanum.ds != undefined &&datanum.ds != "" &&datanum.ds[0].status == "000000"){
                    //             // jw.ts.toast(datanum.ds[0].msg);
                    //             this.dhshow=true
                    //         }else{
                    //             jw.ts.toast(datanum.ds[0].msg);
                    //         }
                    //     })
                    // }else{
                    //     this.set=true
                    // };
                },
                // 更新出价
                gxcj: function () {
                    this.paimeilist();
                    var _this = this;
                    //api42275 更新出价
                    jw.submit("api42275", {
                        FId: api.pageParam.FId, //活动id
                        FUserId: jw.data.get("userid") //登录id
                    }, function (datares) {
                        if (datares.ds != undefined && datares.ds != "" && datares.ds[0]
                            .status == "000000") {
                            // jw.ts.toast(datares.ds[0].msg);
                            _this.memberlist = datares.ds1; //参与竞价人员列表
                            _this.jpname = datares.ds2[0]; //当前时间
                        } else {
                            // _this.jpname=datares.ds1;
                            jw.ts.toast(datares.ds[0].msg);
                            _this.jpname = datares.ds2[0];
                        }
                    })
                },
                // 去充值
                gochongzhi: function () {
                    this.bzjczshow = false;
                    jw.openWin({
                        name: "my_wallet",
                        url: "../myself/my_wallet.html"
                    })
                },
                //减价
                JianJia:function(){
                    //alert(123)
                    var _this = this
                    $('#number').val(parseInt($('#number').val())-parseInt(_this.order.FNum))
                    if(_this.order.FCostTxt>=$('#number').val()){
                        $('#number').val(_this.order.FCostTxt+_this.order.FNum)
                    }
                    _this.inputsave = $('#number').val()
                },
                //加价
                JiaJIa:function(){
                    var _this = this
                    //console.log(_this.order.FNum)
                    $('#number').val(parseInt($('#number').val())+parseInt(_this.order.FNum))
                    _this.inputsave = $('#number').val()
                },
                //加一手按钮
                justbuy: function () {
                    var _this = this;
                    if(this.PDinput==0){
                        setTimeout(function(){
                            if(_this.jpname.FMember>=1){
                                $('#number').val(_this.order.FCostTxt+_this.order.FNum)
                                _this.inputsave = _this.order.FCostTxt+_this.order.FNum
                            }else{
                                $("#number").val(_this.order.FNum+_this.order.FCost)
                                _this.inputsave = _this.order.FCostTxt+_this.order.FNum
                            }
                        },50)
                        _this.PDinput=1//记住Iput用的
                    }
                    else{
                        setTimeout(function(){
                            if(_this.inputsave<_this.order.FCostTxt){
                                $("#number").val(_this.order.FNum+_this.order.FCostTxt)
                            }else{
                                $("#number").val(_this.inputsave)
                            }
                        },50)
                    }
                    if (_this.addoneshow = false) {
                    } else {
                        _this.addoneshow = true;
                        if (_this.addoneshow == "true") {
                            this.chujiabtn(0);
                            setTimeout(() => {
                            }, 1000);
                        }
                    }
                },
                // 加价
                chujiabtn: function (ifFDeposit) {
                    var _this = this;
                    var pricemax = 0;
                    //var price = _this.FNum == null || _this.FNum == "" ? 1 : parseInt(_this.FNum);
                    var order_FNum = parseInt($('#number').val());
                    //var price = _this.FNum == null || _this.FNum == "" ? order_FNum : parseInt(_this.FNum);
                    var priceNum = 0;
                    try {
                        if (null != _this.FNum && _this.FNum.toString().indexOf(".") != -1) {
                            jw.ts.toast('请输入整数');
                            return;
                        }
                        if (null != _this.memberlist && _this.memberlist.length > 0) {
                            pricemax = _this.memberlist[0].FNum
                        }

                        if(_this.FNum == null || _this.FNum == ""){
                            priceNum = order_FNum;
                        } else {
                            priceNum = parseInt(_this.FNum);
                        }

                        if (priceNum <= pricemax) {
                            jw.ts.toast('输入价格不能小于或等于当前领先数额');
                            return;
                        }
                        /*console.error("price----------->"+price);
                        console.error("priceNum----------->"+priceNum);*/
                    } catch
                        (e) {
                        console.error(e);
                    }
                    jw.submit("api42212", {
                        FId: api.pageParam.FId, //活动id
                        FUserId: jw.data.get("userid"), //登录id
                        ifFDeposit: ifFDeposit, // 是否冻结保证金0否1是
                        FNum: priceNum
                        // FNum:  _this.FNum == null || _this.FNum == "" ? 1 : parseInt(_this.FNum)
                    }, function (datas) {
                        _this.bzjshow = false;
                        if (datas.ds != undefined && datas.ds.length > 0) {
                            if (datas.ds[0].status == "000000") {
                                jw.ts.toast(datas.ds[0].msg);
                                _this.addoneshow = false;
                                _this.gxcj();
                            } else if (datas.ds[0].status == "666666") {
                                _this.bzjshow = true;
                                _this.bzjtext = datas.ds[0].msg;
                            } else if (datas.ds[0].status == "888888") {
                                _this.bzjczshow = true;
                            } else if (datas.ds[0].status == "999999") {
                                _this.bzjczshow = false;
                                jw.ts.toast(datas.ds[0].msg);
                            } else {
                                jw.ts.toast(datas.ds[0].msg);
                                _this.addoneshow = false;
                                _this.gxcj();
                            }
                        } else {

                        }
                    });
                },
                jump: function () {
                    jw.openWin({
                        name: "paimaidet",
                        url: "../myself/paimaidet.html",
                        pageParam: {
                            FId: this.order.FOrderId
                        }
                    })
                }
                ,
                /* 分享 */
                share: function () {
                    var _this = this;
                    // FId: api.pageParam.FId, //活动id
                    //     FUserId: jw.data.get("userid") //登录id

                    var url = "http://www.yunpuer.com/app_paimai_details/" + api.pageParam.FId + "-" + jw.data.get("userid") + ".html";

                    // var url = "http://www.yunpuer.com/app_paimai_details/" + _this.Ftype + "-" + _this
                    //     .FPageType + "-" + _this.FBusinessId + "-" + _this.FlashSaleId + ".html";
                    var text = "商品名称："+_this.order.FTitle+"开始时间："+_this.order.FOpenTime+ " 结束时间："+_this.order.FEndTime +" 当前竞拍价："+_this.order.FCostTxt+"目标人次："+_this.order.FMinNum+"已经报名："+_this.order.AuctionMember+"剩余天数："+_this.order.AuctionCount
                    jw.openFrame({
                        name: 'share',
                        url: '../share.html',
                        pageParam: {
                            text:text,
                            FType: '0',
                            Fid: _this.FBusinessId,
                            path: url,
                            thumb:_this.order.FImg
                        }
                    })
                },
                chgj: function () {
                    this.addoneshow = false;
                },
                //联系客服
                lxkf: function () {
                    window.location.href = 'tel:' + 15867203999;
                },
                navclick1(t) {
                    this.navindex = t;
                },
            }
        })
    }
    $(function () {
        console.log("-----------------------------")
       var clipboard = new Clipboard('.btn');
       //优雅降级:safari 版本号>=10,提示复制成功;否则提示需在文字选中后，手动选择“拷贝”进行复制
       clipboard.on('success', function(e) {
        //    alert('复制成功!')
        jw.ts.toast('复制成功!');
           //console.log($(this))
           e.clearSelection();
       });
       clipboard.on('error', function(e) {
           //alert('请选择“拷贝”进行复制!')
       });
   })
</script>

</html>
